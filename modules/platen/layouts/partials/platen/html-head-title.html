{{- $context := . -}}
{{- $title := "" -}}

{{- range $feature, $settings := $context.Site.Params.Platen.Features -}}
  {{- if and (eq "" $title) $settings.Enabled -}}
    {{- with $settings.Partials.Title -}}
      {{ $title = partial . $context }}
    {{- end -}}
  {{- end -}}
{{- end -}}

{{- if eq "" $title -}}
  {{- $title = printf "%s | %s" (partial "platen/title" $context) $context.Site.Title -}}
{{- end }}

{{- return $title -}}